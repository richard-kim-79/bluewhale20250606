(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8351:function(e,t,a){Promise.resolve().then(a.bind(a,5390))},5390:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return k}});var s=a(7437),l=a(2265),r=a(7648),n=a(4362),o=a(9295);function i(e){let{activeTab:t,onTabChange:a}=e;return(0,s.jsx)("div",{className:"border-b border-gray-200",children:(0,s.jsx)("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:[{id:"for-you",name:"추천 (For You)"},{id:"local",name:"주변 (Local)"},{id:"global",name:"글로벌 Top"},{id:"following",name:"팔로잉"}].map(e=>(0,s.jsx)("button",{onClick:()=>a(e.id),className:"\n              whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm\n              ".concat(t===e.id?"border-blue-whale-600 text-blue-whale-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","\n            "),"aria-current":t===e.id?"page":void 0,children:e.name},e.id))})})}var d=a(9376),c=a(8223),h=a(3145),x=()=>{let e=(0,d.useRouter)(),{isAuthenticated:t}=(0,n.a)(),[a,o]=(0,l.useState)([]),[i,x]=(0,l.useState)(!0),[u,m]=(0,l.useState)(""),[g,f]=(0,l.useState)(null),[p,j]=(0,l.useState)({});(0,l.useEffect)(()=>{(async()=>{x(!0);try{let e={lat:37.5665,lng:126.978};try{if(navigator.geolocation){let t=await new Promise((e,t)=>{navigator.geolocation.getCurrentPosition(e,t,{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})});e={lat:t.coords.latitude,lng:t.coords.longitude},f(e)}}catch(t){console.error("Error getting user location:",t),f(e)}let t=await c.gT.getPersonalizedContent({page:1,limit:10,location:e});o((null==t?void 0:t.data)||[]),x(!1)}catch(e){console.error("Error fetching personalized content:",e),m("맞춤 콘텐츠를 불러오는데 실패했습니다."),o([]),x(!1)}})()},[]);let w=t=>{e.push("/content/".concat(t))},b=async(e,s)=>{if(s.stopPropagation(),!p[e]&&t){j(t=>({...t,[e]:!0}));try{let t=a.find(t=>t.author.id===e);if(!t)return;t.author.isFollowing?(await c.TV.unfollowUser(e),o(t=>t.map(t=>t.author.id===e?{...t,author:{...t.author,isFollowing:!1}}:t))):(await c.TV.followUser(e),o(t=>t.map(t=>t.author.id===e?{...t,author:{...t.author,isFollowing:!0}}:t)))}catch(e){console.error("Error toggling follow status:",e)}finally{j(t=>({...t,[e]:!1}))}}};return i?(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-whale-600"})}):u?(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:[(0,s.jsx)("p",{className:"font-bold",children:"오류 발생"}),(0,s.jsx)("p",{children:u})]}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"추천 콘텐츠"}),0===a.length?(0,s.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-700 px-4 py-3 rounded",children:[(0,s.jsx)("p",{className:"font-bold",children:"콘텐츠가 없습니다"}),(0,s.jsx)("p",{children:"현재 추천할 콘텐츠가 없습니다."})]}):(0,s.jsx)("div",{className:"space-y-4",children:a.map((e,a)=>(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-shadow p-4 cursor-pointer",onClick:()=>w(e.id),children:[0===a&&(0,s.jsx)("div",{className:"mb-2 inline-block bg-blue-whale-100 text-blue-whale-800 text-xs font-medium px-2 py-1 rounded-full",children:"추천 콘텐츠"}),(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 hover:text-blue-whale-600",children:e.title}),(0,s.jsxs)("div",{className:"flex items-center mt-1 text-sm text-gray-500",children:[(0,s.jsxs)(r.default,{href:"/user/".concat(e.author.id),className:"flex items-center hover:text-blue-whale-600",onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("div",{className:"relative w-5 h-5 rounded-full overflow-hidden bg-gray-200 mr-1",children:e.author.avatar?(0,s.jsx)(h.default,{src:e.author.avatar,alt:e.author.name||e.author.email,fill:!0,className:"object-cover"}):(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-500 text-xs",children:(e.author.name||e.author.email).charAt(0).toUpperCase()})}),(0,s.jsx)("span",{children:e.author.name||e.author.email})]}),(0,s.jsx)("span",{className:"mx-2",children:"•"}),(0,s.jsx)("span",{children:new Date(e.createdAt).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})}),t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"mx-2",children:"•"}),(0,s.jsx)("button",{onClick:t=>b(e.author.id,t),disabled:p[e.author.id],className:"text-xs font-medium ".concat(e.author.isFollowing?"text-gray-500 hover:text-gray-700":"text-blue-whale-600 hover:text-blue-whale-800"),children:p[e.author.id]?(0,s.jsx)("span",{className:"inline-block w-3 h-3 border-t-2 border-blue-whale-600 rounded-full animate-spin"}):e.author.isFollowing?"팔로잉":"팔로우"})]})]}),(0,s.jsx)("p",{className:"mt-2 text-sm text-gray-600 line-clamp-2",children:e.summary})]}),(0,s.jsxs)("div",{className:"flex flex-col items-end",children:[(0,s.jsx)("div",{className:"".concat("pdf"===e.type?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"," px-2 py-1 rounded-full text-xs font-medium"),children:"pdf"===e.type?"PDF":"TEXT"}),(0,s.jsxs)("div",{className:"mt-2 flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4 mr-1 text-blue-600",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.894 20.567L16.5 21.75l-.394-1.183a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 001.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 001.423 1.423l1.183.394-1.183.394a2.25 2.25 0 00-1.423 1.423z"})}),(0,s.jsx)("span",{className:"text-xs text-blue-600",children:e.aiScore})]}),e.hasLocation&&(0,s.jsxs)("div",{className:"mt-1 flex items-center",children:[(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4 mr-1 text-gray-500",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"})]}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:e.distance?"".concat(e.distance.toFixed(1),"km 거리"):"위치 정보"})]})]})]})]},e.id))})]})},u=a(2520),m=a.n(u);a(4982);var g=a(257),f=e=>{let{contents:t,onContentSelect:a}=e,r=(0,l.useRef)(null),n=(0,l.useRef)(null),o=(0,l.useRef)([]),[i,d]=(0,l.useState)(null),[c,h]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{d({lat:e.coords.latitude,lng:e.coords.longitude})},e=>{console.error("Error getting location:",e),d({lat:37.5665,lng:126.978})}):d({lat:37.5665,lng:126.978})},[]),(0,l.useEffect)(()=>{if(!r.current||!i)return;let e=g.env.NEXT_PUBLIC_MAPBOX_TOKEN;if(!e){console.error("Mapbox token is missing. Please add NEXT_PUBLIC_MAPBOX_TOKEN to your .env.local file.");return}if(m().accessToken=e,!n.current)return n.current=new(m()).Map({container:r.current,style:"mapbox://styles/mapbox/streets-v12",center:[i.lng,i.lat],zoom:13}),n.current.addControl(new(m()).NavigationControl,"top-right"),new(m()).Marker({color:"#3B82F6"}).setLngLat([i.lng,i.lat]).addTo(n.current).setPopup(new(m()).Popup().setHTML("<strong>내 위치</strong>")),n.current.on("load",()=>{h(!0)}),()=>{n.current&&(n.current.remove(),n.current=null)}},[i]),(0,l.useEffect)(()=>{n.current&&c&&(o.current.forEach(e=>e.remove()),o.current=[],t.forEach(e=>{let t=document.createElement("div");t.className="content-marker",t.style.width="25px",t.style.height="25px",t.style.borderRadius="50%",t.style.backgroundColor="pdf"===e.type?"#DBEAFE":"#D1FAE5",t.style.border="2px solid",t.style.borderColor="pdf"===e.type?"#3B82F6":"#10B981",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.style.fontWeight="bold",t.style.fontSize="10px",t.style.color="pdf"===e.type?"#1E40AF":"#047857",t.style.cursor="pointer",t.innerHTML=e.aiScore.toString();let s=new(m()).Popup({offset:25}).setHTML("<strong>".concat(e.title,'</strong><br/>\n         <span style="color: ').concat("pdf"===e.type?"#3B82F6":"#10B981",'">\n           ').concat("pdf"===e.type?"PDF":"TEXT","\n         </span>")),l=new(m()).Marker(t).setLngLat([e.location.lng,e.location.lat]).setPopup(s).addTo(n.current);t.addEventListener("click",()=>{a(e.id)}),o.current.push(l)}))},[t,c,a]),(0,s.jsx)("div",{className:"w-full h-full rounded-lg overflow-hidden border border-gray-200",children:(0,s.jsx)("div",{className:"w-full h-full",ref:r,children:!g.env.NEXT_PUBLIC_MAPBOX_TOKEN&&(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gray-100",children:(0,s.jsx)("p",{className:"text-gray-500",children:"Mapbox token is missing. Please add NEXT_PUBLIC_MAPBOX_TOKEN to your .env.local file."})})})})},p=()=>{let e=(0,d.useRouter)(),{isAuthenticated:t}=(0,n.a)(),[a,o]=(0,l.useState)([]),[i,x]=(0,l.useState)(!0),[u,m]=(0,l.useState)(""),[g,p]=(0,l.useState)("map"),[j,w]=(0,l.useState)(null),[b,v]=(0,l.useState)({});(0,l.useEffect)(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{w({lat:e.coords.latitude,lng:e.coords.longitude})},e=>{console.error("Error getting location:",e),m("위치 정보를 가져오는데 실패했습니다. 위치 권한을 확인해주세요."),w({lat:37.5665,lng:126.978})}):(m("이 브라우저는 위치 정보를 지원하지 않습니다."),w({lat:37.5665,lng:126.978}))},[]),(0,l.useEffect)(()=>{(async()=>{if(j){x(!0);try{let e=await c.gT.getLocalContent({page:1,limit:10,lat:j.lat,lng:j.lng,radius:10});o(e.data),x(!1)}catch(e){console.error("Error fetching local contents:",e),m("주변 콘텐츠를 불러오는데 실패했습니다."),x(!1)}}})()},[j]);let y=t=>{e.push("/content/".concat(t))},N=async(e,s)=>{if(s.stopPropagation(),!b[e]&&t){v(t=>({...t,[e]:!0}));try{let t=a.find(t=>t.author.id===e);if(!t)return;t.author.isFollowing?(await c.TV.unfollowUser(e),o(t=>t.map(t=>t.author.id===e?{...t,author:{...t.author,isFollowing:!1}}:t))):(await c.TV.followUser(e),o(t=>t.map(t=>t.author.id===e?{...t,author:{...t.author,isFollowing:!0}}:t)))}catch(e){console.error("Error toggling follow status:",e)}finally{v(t=>({...t,[e]:!1}))}}};if(i)return(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-whale-600"})});if(u)return(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:[(0,s.jsx)("p",{className:"font-bold",children:"오류 발생"}),(0,s.jsx)("p",{children:u})]});let k=a.map(e=>({id:e.id,title:e.title,location:e.location,type:e.type,aiScore:e.aiScore}));return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"내 주변 콘텐츠"}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("button",{onClick:()=>p("map"),className:"px-3 py-1 rounded-md text-sm font-medium ".concat("map"===g?"bg-blue-whale-100 text-blue-whale-800":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"지도 보기"}),(0,s.jsx)("button",{onClick:()=>p("list"),className:"px-3 py-1 rounded-md text-sm font-medium ".concat("list"===g?"bg-blue-whale-100 text-blue-whale-800":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"목록 보기"})]})]}),0===a.length?(0,s.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-700 px-4 py-3 rounded",children:[(0,s.jsx)("p",{className:"font-bold",children:"주변에 콘텐츠가 없습니다"}),(0,s.jsx)("p",{children:"현재 위치 주변 10km 내에 등록된 콘텐츠가 없습니다."})]}):(0,s.jsx)(s.Fragment,{children:"map"===g?(0,s.jsx)("div",{className:"h-96",children:(0,s.jsx)(f,{contents:k,onContentSelect:y})}):(0,s.jsx)("div",{className:"space-y-4",children:a.sort((e,t)=>e.distance-t.distance).map(e=>(0,s.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-shadow p-4 cursor-pointer",onClick:()=>y(e.id),children:(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 hover:text-blue-whale-600",children:e.title}),(0,s.jsxs)("div",{className:"flex items-center mt-1 text-sm text-gray-500",children:[(0,s.jsxs)(r.default,{href:"/user/".concat(e.author.id),className:"flex items-center hover:text-blue-whale-600",onClick:e=>{e.stopPropagation()},children:[(0,s.jsx)("div",{className:"relative w-5 h-5 rounded-full overflow-hidden bg-gray-200 mr-1",children:e.author.avatar?(0,s.jsx)(h.default,{src:e.author.avatar,alt:e.author.name||e.author.email,fill:!0,className:"object-cover"}):(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-500 text-xs",children:(e.author.name||e.author.email).charAt(0).toUpperCase()})}),(0,s.jsx)("span",{children:e.author.name||e.author.email})]}),(0,s.jsx)("span",{className:"mx-2",children:"•"}),(0,s.jsx)("span",{children:new Date(e.createdAt).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})}),t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"mx-2",children:"•"}),(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),N(e.author.id,t)},disabled:b[e.author.id],className:"text-xs font-medium ".concat(e.author.isFollowing?"text-gray-500 hover:text-gray-700":"text-blue-whale-600 hover:text-blue-whale-800"),children:b[e.author.id]?(0,s.jsx)("span",{className:"inline-block w-3 h-3 border-t-2 border-blue-whale-600 rounded-full animate-spin"}):e.author.isFollowing?"팔로잉":"팔로우"})]})]}),(0,s.jsx)("p",{className:"mt-2 text-sm text-gray-600 line-clamp-2",children:e.summary})]}),(0,s.jsxs)("div",{className:"flex flex-col items-end",children:[(0,s.jsx)("div",{className:"".concat("pdf"===e.type?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"," px-2 py-1 rounded-full text-xs font-medium"),children:"pdf"===e.type?"PDF":"TEXT"}),(0,s.jsxs)("div",{className:"mt-2 flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4 mr-1 text-blue-600",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.894 20.567L16.5 21.75l-.394-1.183a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 001.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 001.423 1.423l1.183.394-1.183.394a2.25 2.25 0 00-1.423 1.423z"})}),(0,s.jsx)("span",{className:"text-xs text-blue-600",children:e.aiScore})]}),(0,s.jsxs)("div",{className:"mt-1 flex items-center",children:[(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4 mr-1 text-gray-500",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"})]}),(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:[e.distance.toFixed(1),"km 거리"]})]})]})]})},e.id))})})]})},j=a(4747),w=a(6410),b=()=>{let e=(0,d.useRouter)(),{isAuthenticated:t,user:a}=(0,n.a)(),[o,i]=(0,l.useState)([]),[x,u]=(0,l.useState)(!0),[m,g]=(0,l.useState)(""),[f,p]=(0,l.useState)({});(0,l.useEffect)(()=>{(async()=>{u(!0);try{let e=await c.gT.getGlobalTopContent({page:1,limit:10});i((null==e?void 0:e.data)||[]),u(!1)}catch(e){console.error("Error fetching global top content:",e),g("글로벌 Top 콘텐츠를 불러오는데 실패했습니다."),i([]),u(!1)}})()},[]);let b=t=>{e.push("/content/".concat(t))},v=async(e,a)=>{if(a.stopPropagation(),!f[e]&&t){p(t=>({...t,[e]:!0}));try{let t=o.find(t=>t.author.id===e);if(!t)return;t.author.isFollowing?(await c.TV.unfollowUser(e),i(t=>t.map(t=>t.author.id===e?{...t,author:{...t.author,isFollowing:!1}}:t))):(await c.TV.followUser(e),i(t=>t.map(t=>t.author.id===e?{...t,author:{...t.author,isFollowing:!0}}:t)))}catch(e){console.error("Error toggling follow status:",e)}finally{p(t=>({...t,[e]:!1}))}}};return x?(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-whale-600"})}):m?(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:[(0,s.jsx)("p",{className:"font-bold",children:"오류 발생"}),(0,s.jsx)("p",{children:m})]}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"글로벌 Top 콘텐츠"}),0===o.length?(0,s.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-700 px-4 py-3 rounded",children:[(0,s.jsx)("p",{className:"font-bold",children:"콘텐츠가 없습니다"}),(0,s.jsx)("p",{children:"현재 글로벌 Top 콘텐츠가 없습니다."})]}):(0,s.jsx)("div",{className:"space-y-4",children:o.map(e=>{var l;return(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-shadow p-4 cursor-pointer",onClick:()=>b(e.id),children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"flex-shrink-0 mr-3",children:e.author.avatar?(0,s.jsx)(h.default,{src:e.author.avatar,alt:e.author.name||e.author.email,width:40,height:40,className:"rounded-full object-cover"}):(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-blue-whale-100 flex items-center justify-center text-blue-whale-800 font-medium text-sm",children:((null===(l=e.author.name)||void 0===l?void 0:l[0])||e.author.email[0]).toUpperCase()})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(r.default,{href:"/user/".concat(e.author.id),onClick:e=>e.stopPropagation(),className:"text-sm font-medium text-gray-900 hover:underline",children:e.author.name||e.author.email}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:(0,j.Q)(new Date(e.createdAt),{addSuffix:!0,locale:w.ko})}),t&&(null==a?void 0:a.id)!==e.author.id&&(0,s.jsx)("button",{onClick:t=>v(e.author.id,t),disabled:f[e.author.id],className:"text-xs font-medium mt-1 ".concat(e.author.isFollowing?"text-gray-500 hover:text-gray-700":"text-blue-whale-600 hover:text-blue-whale-800"),children:f[e.author.id]?(0,s.jsx)("span",{className:"inline-block w-3 h-3 border-t-2 border-blue-whale-600 rounded-full animate-spin"}):e.author.isFollowing?"팔로잉":"팔로우"})]})]}),(0,s.jsxs)("div",{className:"flex flex-col items-end",children:[(0,s.jsx)("div",{className:"".concat("pdf"===e.type?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"," px-2 py-1 rounded-full text-xs font-medium"),children:"pdf"===e.type?"PDF":"TEXT"}),(0,s.jsxs)("div",{className:"mt-2 flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4 mr-1 text-blue-600",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.894 20.567L16.5 21.75l-.394-1.183a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 001.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 001.423 1.423l1.183.394-1.183.394a2.25 2.25 0 00-1.423 1.423z"})}),(0,s.jsx)("span",{className:"text-xs text-blue-600",children:e.aiScore})]}),e.hasLocation&&(0,s.jsxs)("div",{className:"mt-1 flex items-center",children:[(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4 mr-1 text-gray-500",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"})]}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:"위치 정보"})]})]})]}),(0,s.jsxs)("div",{className:"ml-1",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:e.title}),(0,s.jsx)("p",{className:"text-sm text-gray-600 line-clamp-3 mb-2",children:e.summary})]})]},e.id)})})]})},v=()=>{let e=(0,d.useRouter)(),{isAuthenticated:t,user:a}=(0,n.a)(),[o,i]=(0,l.useState)([]),[x,u]=(0,l.useState)(!0),[m,g]=(0,l.useState)(""),[f,p]=(0,l.useState)({});(0,l.useEffect)(()=>{(async()=>{if(!t){g("팔로우한 작성자의 콘텐츠를 보려면 로그인이 필요합니다."),u(!1);return}u(!0);try{let e=(await c.TV.getUserFollowing(a.id,{page:1,limit:50})).data;if(0===e.length){i([]),u(!1);return}let t=e.map(async e=>{try{return(await c.gT.getUserContent(e.id,{page:1,limit:5})).data.map(e=>({...e,author:{...e.author,isFollowing:!0}}))}catch(t){return console.error("Error fetching content for user ".concat(e.id,":"),t),[]}}),s=(await Promise.all(t)).flat().sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime());i(s),u(!1)}catch(e){console.error("Error fetching following content:",e),g("팔로우한 작성자의 콘텐츠를 불러오는데 실패했습니다."),u(!1)}})()},[t,a]);let b=t=>{e.push("/content/".concat(t))},v=async(e,a)=>{if(a.stopPropagation(),!f[e]&&t){p(t=>({...t,[e]:!0}));try{let t=o.find(t=>t.author.id===e);if(!t)return;t.author.isFollowing?(await c.TV.unfollowUser(e),i(t=>t.map(t=>t.author.id===e?{...t,author:{...t.author,isFollowing:!1}}:t)),setTimeout(()=>{i(t=>t.filter(t=>t.author.id!==e))},500)):(await c.TV.followUser(e),i(t=>t.map(t=>t.author.id===e?{...t,author:{...t.author,isFollowing:!0}}:t)))}catch(e){console.error("Error toggling follow status:",e)}finally{p(t=>({...t,[e]:!1}))}}};return x?(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-whale-600"})}):t?m?(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:[(0,s.jsx)("p",{className:"font-bold",children:"오류 발생"}),(0,s.jsx)("p",{children:m})]}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"팔로잉 콘텐츠"}),0===o.length?(0,s.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-700 px-4 py-3 rounded",children:[(0,s.jsx)("p",{className:"font-bold",children:"콘텐츠가 없습니다"}),(0,s.jsx)("p",{children:"팔로우한 작성자의 콘텐츠가 없습니다. 관심 있는 작성자를 팔로우해보세요!"}),(0,s.jsx)("button",{onClick:()=>e.push("/"),className:"mt-2 bg-blue-whale-600 text-white px-4 py-2 rounded hover:bg-blue-whale-700 transition-colors",children:"작성자 찾기"})]}):(0,s.jsx)("div",{className:"space-y-4",children:o.map(e=>(0,s.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-shadow p-4 cursor-pointer",onClick:()=>b(e.id),children:(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 hover:text-blue-whale-600",children:e.title}),(0,s.jsxs)("div",{className:"flex items-center mt-1 text-sm text-gray-500",children:[(0,s.jsxs)(r.default,{href:"/user/".concat(e.author.id),className:"flex items-center hover:text-blue-whale-600",onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("div",{className:"relative w-5 h-5 rounded-full overflow-hidden bg-gray-200 mr-1",children:e.author.avatar?(0,s.jsx)(h.default,{src:e.author.avatar,alt:e.author.name||e.author.email,fill:!0,className:"object-cover"}):(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-500 text-xs",children:(e.author.name||e.author.email).charAt(0).toUpperCase()})}),(0,s.jsx)("span",{children:e.author.name||e.author.email})]}),(0,s.jsx)("span",{className:"mx-2",children:"•"}),(0,s.jsx)("span",{children:(0,j.Q)(new Date(e.createdAt),{addSuffix:!0,locale:w.ko})}),(0,s.jsx)("span",{className:"mx-2",children:"•"}),(0,s.jsx)("button",{onClick:t=>v(e.author.id,t),disabled:f[e.author.id],className:"text-xs font-medium ".concat(e.author.isFollowing?"text-gray-500 hover:text-gray-700":"text-blue-whale-600 hover:text-blue-whale-800"),children:f[e.author.id]?(0,s.jsx)("span",{className:"inline-block w-3 h-3 border-t-2 border-blue-whale-600 rounded-full animate-spin"}):e.author.isFollowing?"팔로잉":"팔로우"})]}),(0,s.jsx)("p",{className:"mt-2 text-sm text-gray-600 line-clamp-2",children:e.summary})]}),(0,s.jsxs)("div",{className:"flex flex-col items-end",children:[(0,s.jsx)("div",{className:"".concat("pdf"===e.type?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"," px-2 py-1 rounded-full text-xs font-medium"),children:"pdf"===e.type?"PDF":"TEXT"}),(0,s.jsxs)("div",{className:"mt-2 flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4 mr-1 text-blue-600",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.894 20.567L16.5 21.75l-.394-1.183a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 001.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 001.423 1.423l1.183.394-1.183.394a2.25 2.25 0 00-1.423 1.423z"})}),(0,s.jsx)("span",{className:"text-xs text-blue-600",children:e.aiScore})]}),e.hasLocation&&(0,s.jsxs)("div",{className:"mt-1 flex items-center",children:[(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4 mr-1 text-gray-500",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"})]}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:"위치 정보"})]})]})]})},e.id))})]}):(0,s.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-700 px-4 py-3 rounded",children:[(0,s.jsx)("p",{className:"font-bold",children:"로그인이 필요합니다"}),(0,s.jsx)("p",{children:"팔로우한 작성자의 콘텐츠를 보려면 로그인해주세요."}),(0,s.jsx)("button",{onClick:()=>e.push("/login"),className:"mt-2 bg-blue-whale-600 text-white px-4 py-2 rounded hover:bg-blue-whale-700 transition-colors",children:"로그인하기"})]})},y=a(6681),N=()=>{let{user:e}=(0,n.a)();return(0,s.jsx)(y.Z,{limit:3,title:"팔로우 추천",excludeUserId:null==e?void 0:e.id})};function k(){let{isAuthenticated:e,loading:t}=(0,n.a)(),[a,d]=(0,l.useState)("for-you");return(0,s.jsxs)("main",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)(o.Z,{}),(0,s.jsx)("div",{className:"max-w-4xl mx-auto px-4 py-6",children:e||t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i,{activeTab:a,onTabChange:d}),(0,s.jsx)("div",{className:"mt-6",children:t?(0,s.jsx)("div",{className:"flex justify-center py-12",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-whale-600"})}):(0,s.jsxs)("div",{children:["for-you"===a&&(0,s.jsxs)("div",{className:"md:flex md:space-x-6",children:[(0,s.jsx)("div",{className:"md:w-3/4",children:(0,s.jsx)(x,{})}),(0,s.jsx)("div",{className:"md:w-1/4 mt-6 md:mt-0",children:(0,s.jsx)(N,{})})]}),"local"===a&&(0,s.jsxs)("div",{className:"md:flex md:space-x-6",children:[(0,s.jsx)("div",{className:"md:w-3/4",children:(0,s.jsx)(p,{})}),(0,s.jsx)("div",{className:"md:w-1/4 mt-6 md:mt-0",children:(0,s.jsx)(N,{})})]}),"global"===a&&(0,s.jsxs)("div",{className:"md:flex md:space-x-6",children:[(0,s.jsx)("div",{className:"md:w-3/4",children:(0,s.jsx)(b,{})}),(0,s.jsx)("div",{className:"md:w-1/4 mt-6 md:mt-0",children:(0,s.jsx)(N,{})})]}),"following"===a&&(0,s.jsxs)("div",{className:"md:flex md:space-x-6",children:[(0,s.jsx)("div",{className:"md:w-3/4",children:(0,s.jsx)(v,{})}),(0,s.jsx)("div",{className:"md:w-1/4 mt-6 md:mt-0",children:(0,s.jsx)(N,{})})]})]})}),(0,s.jsx)("div",{className:"fixed bottom-6 right-6",children:(0,s.jsx)(r.default,{href:"/create",className:"btn-primary flex items-center justify-center h-14 w-14 rounded-full shadow-lg",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-6 h-6",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})})})})]}):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold text-blue-whale-700 mb-6",children:"블루웨일 프로토콜에 오신 것을 환영합니다"}),(0,s.jsx)("p",{className:"text-xl mb-8 text-gray-600",children:"지역 기반의 실시간 지식과 AI가 검증한 글로벌 인사이트를 연결하는 탈중앙화 프로토콜"}),(0,s.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,s.jsx)(r.default,{href:"/login",className:"btn-primary",children:"로그인"}),(0,s.jsx)(r.default,{href:"/register",className:"btn-secondary",children:"회원가입"})]})]})})]})}},6681:function(e,t,a){"use strict";var s=a(7437),l=a(2265),r=a(8223),n=a(3145),o=a(7648),i=a(4362);t.Z=e=>{let{limit:t=3,title:a="팔로우 추천",excludeUserId:d}=e,{isAuthenticated:c,user:h}=(0,i.a)(),[x,u]=(0,l.useState)([]),[m,g]=(0,l.useState)(!0),[f,p]=(0,l.useState)(""),[j,w]=(0,l.useState)({});(0,l.useEffect)(()=>{c&&(async()=>{try{g(!0);let e=(await r.TV.searchUsers("",{limit:t+5})).data||[];(null==h?void 0:h.id)&&(e=e.filter(e=>e.id!==h.id)),d&&(e=e.filter(e=>e.id!==d)),e=e.slice(0,t),u(e),g(!1)}catch(e){console.error("Error fetching recommended users:",e),p("추천 사용자를 불러오는데 실패했습니다."),g(!1)}})()},[c,null==h?void 0:h.id,t,d]);let b=async e=>{if(!j[e]){w(t=>({...t,[e]:!0}));try{let t=x.find(t=>t.id===e);if(!t)return;t.isFollowing?(await r.TV.unfollowUser(e),u(t=>t.map(t=>t.id===e?{...t,isFollowing:!1}:t))):(await r.TV.followUser(e),u(t=>t.map(t=>t.id===e?{...t,isFollowing:!0}:t)))}catch(e){console.error("Error toggling follow status:",e)}finally{w(t=>({...t,[e]:!1}))}}};return c?m?(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[(0,s.jsx)("h2",{className:"text-lg font-medium mb-4",children:a}),(0,s.jsx)("div",{className:"animate-pulse space-y-3",children:[...Array(t)].map((e,t)=>(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)("div",{className:"rounded-full bg-gray-200 h-10 w-10"}),(0,s.jsxs)("div",{className:"flex-1 space-y-2 py-1",children:[(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})]},t))})]}):f?(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[(0,s.jsx)("h2",{className:"text-lg font-medium mb-4",children:a}),(0,s.jsx)("p",{className:"text-red-500 text-sm",children:f})]}):0===x.length?null:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[(0,s.jsx)("h2",{className:"text-lg font-medium mb-4",children:a}),(0,s.jsxs)("div",{className:"space-y-4",children:[x.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)(o.default,{href:"/user/".concat(e.id),className:"flex items-center flex-grow",children:[(0,s.jsx)("div",{className:"relative w-10 h-10 rounded-full overflow-hidden bg-gray-200 mr-3",children:e.avatar?(0,s.jsx)(n.default,{src:e.avatar,alt:e.name||e.email,fill:!0,className:"object-cover"}):(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-500",children:(e.name||e.email).charAt(0).toUpperCase()})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-medium text-sm",children:e.name||e.email}),e.bio?(0,s.jsx)("p",{className:"text-xs text-gray-500 truncate max-w-[150px]",children:e.bio}):(0,s.jsx)("p",{className:"text-xs text-gray-500 truncate max-w-[150px]",children:e.email})]})]}),(0,s.jsx)("button",{onClick:()=>b(e.id),disabled:j[e.id],className:"ml-2 px-3 py-1 text-xs font-medium rounded-full ".concat(e.isFollowing?"text-gray-700 bg-gray-100 hover:bg-gray-200":"text-white bg-blue-whale-600 hover:bg-blue-whale-700"," focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-whale-500"),children:j[e.id]?(0,s.jsx)("span",{className:"inline-block w-4 h-4 border-2 border-t-transparent border-white rounded-full animate-spin"}):e.isFollowing?"팔로잉":"팔로우"})]},e.id)),(0,s.jsx)("div",{className:"pt-2 text-center",children:(0,s.jsx)(o.default,{href:"/search?tab=users",className:"text-sm text-blue-whale-600 hover:text-blue-whale-800",children:"더 많은 사용자 찾기"})})]})]}):null}}},function(e){e.O(0,[508,415,301,648,145,223,295,971,117,744],function(){return e(e.s=8351)}),_N_E=e.O()}]);