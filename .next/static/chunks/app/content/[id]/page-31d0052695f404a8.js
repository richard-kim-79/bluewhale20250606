(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[584],{5015:function(e,t,a){Promise.resolve().then(a.bind(a,3441))},3441:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return x}});var s=a(7437),r=a(2265),n=a(9376),l=a(7648),o=a(4362),i=a(8223),c=a(2520),d=a.n(c);a(4982);var u=a(257),m=e=>{let{location:t,zoom:a=15}=e,n=(0,r.useRef)(null),l=(0,r.useRef)(null),o=(0,r.useRef)(null);return(0,r.useEffect)(()=>{if(!n.current)return;let e=u.env.NEXT_PUBLIC_MAPBOX_TOKEN;if(!e){console.error("Mapbox token is missing. Please add NEXT_PUBLIC_MAPBOX_TOKEN to your .env.local file.");return}if(d().accessToken=e,!l.current)return l.current=new(d()).Map({container:n.current,style:"mapbox://styles/mapbox/streets-v12",center:[t.lng,t.lat],zoom:a}),l.current.addControl(new(d()).NavigationControl,"top-right"),o.current=new(d()).Marker({color:"#3B82F6"}).setLngLat([t.lng,t.lat]).addTo(l.current),()=>{l.current&&(l.current.remove(),l.current=null)}},[t,a]),(0,r.useEffect)(()=>{l.current&&o.current&&(l.current.setCenter([t.lng,t.lat]),o.current.setLngLat([t.lng,t.lat]))},[t]),(0,s.jsx)("div",{className:"w-full h-full",ref:n,children:!u.env.NEXT_PUBLIC_MAPBOX_TOKEN&&(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center bg-gray-100",children:(0,s.jsx)("p",{className:"text-gray-500",children:"Mapbox token is missing. Please add NEXT_PUBLIC_MAPBOX_TOKEN to your .env.local file."})})})},h=a(6681);function x(){let e=(0,n.useParams)(),t=null==e?void 0:e.id;(0,n.useRouter)();let{isAuthenticated:a}=(0,o.a)(),[c,d]=(0,r.useState)(null),[u,x]=(0,r.useState)(!0),[g,f]=(0,r.useState)(""),[w,p]=(0,r.useState)(!1),[v,j]=(0,r.useState)(!1);if((0,r.useEffect)(()=>{(async()=>{if(t){x(!0);try{let e=await i.gT.getContentById(t);d(e.data),p(e.data.isSaved||!1),x(!1)}catch(t){var e,a;console.error("Error fetching content:",t),f((null===(a=t.response)||void 0===a?void 0:null===(e=a.data)||void 0===e?void 0:e.message)||"콘텐츠를 불러오는데 실패했습니다."),x(!1)}}})()},[t]),u)return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-whale-600"})});if(g)return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center p-4",children:[(0,s.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded max-w-md w-full",children:[(0,s.jsx)("p",{className:"font-bold",children:"오류 발생"}),(0,s.jsx)("p",{children:g})]}),(0,s.jsx)(l.default,{href:"/",className:"mt-4 text-blue-whale-600 hover:text-blue-whale-500",children:"홈으로 돌아가기"})]});if(!c)return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center p-4",children:[(0,s.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-700 px-4 py-3 rounded max-w-md w-full",children:[(0,s.jsx)("p",{className:"font-bold",children:"콘텐츠를 찾을 수 없습니다"}),(0,s.jsx)("p",{children:"요청하신 콘텐츠가 존재하지 않거나 삭제되었을 수 있습니다."})]}),(0,s.jsx)(l.default,{href:"/",className:"mt-4 text-blue-whale-600 hover:text-blue-whale-500",children:"홈으로 돌아가기"})]});let y=new Date(c.createdAt).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsxs)(l.default,{href:"/",className:"text-blue-whale-600 hover:text-blue-whale-500 flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5 mr-1",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})}),"홈으로 돌아가기"]})}),(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6",children:[(0,s.jsxs)("div",{className:"lg:w-3/4",children:[(0,s.jsx)("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:c.title}),(0,s.jsx)("div",{className:"\n                ".concat("pdf"===c.type?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800","\n                px-3 py-1 rounded-full text-sm font-medium\n              "),children:"pdf"===c.type?"PDF":"TEXT"})]}),(0,s.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-6",children:[(0,s.jsx)("span",{className:"mr-3",children:c.author.email}),(0,s.jsx)("span",{className:"mr-3",children:"•"}),(0,s.jsx)("span",{children:y}),c.location&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"mr-3",children:"•"}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4 mr-1",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"})]}),(0,s.jsx)("span",{children:"위치 정보 있음"})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center mb-6",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5 mr-2 text-blue-600",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.894 20.567L16.5 21.75l-.394-1.183a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 001.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 001.423 1.423l1.183.394-1.183.394a2.25 2.25 0 00-1.423 1.423z"})}),(0,s.jsxs)("span",{className:"text-blue-600 font-medium",children:["AI 참조 점수: ",c.aiScore]})]}),"pdf"===c.type?(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("div",{className:"bg-gray-50 p-4 rounded border border-gray-200",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"요약"}),(0,s.jsx)("p",{className:"text-gray-600",children:c.summary})]}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsxs)("a",{href:c.pdfUrl,target:"_blank",rel:"noopener noreferrer",className:"btn-primary inline-flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5 mr-2",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m.75 12l3 3m0 0l3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})}),"PDF 파일 보기"]})})]}):(0,s.jsx)("div",{className:"prose max-w-none mb-6",children:(0,s.jsx)("div",{className:"whitespace-pre-wrap",children:c.content})}),c.location&&(0,s.jsxs)("div",{className:"mt-8",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"위치 정보"}),(0,s.jsx)("div",{className:"h-64 rounded-lg overflow-hidden border border-gray-200",children:(0,s.jsx)(m,{location:c.location})})]})]})}),(0,s.jsxs)("div",{className:"mt-8 flex justify-between",children:[(0,s.jsx)(l.default,{href:"/",className:"btn-secondary",children:"홈으로"}),a&&(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsxs)("button",{className:"btn-secondary flex items-center",onClick:()=>{navigator.clipboard.writeText(window.location.href),alert("URL이 클립보드에 복사되었습니다.")},children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5 mr-1",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.217 10.907a2.25 2.25 0 100 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186l9.566-5.314m-9.566 7.5l9.566 5.314m0 0a2.25 2.25 0 103.935 2.186 2.25 2.25 0 00-3.935-2.186zm0-12.814a2.25 2.25 0 103.933-2.185 2.25 2.25 0 00-3.933 2.185z"})}),"공유하기"]}),(0,s.jsxs)("button",{className:"btn-secondary flex items-center ".concat(v?"opacity-50 cursor-not-allowed":""),onClick:async()=>{if(!v&&c){j(!0);try{w?(await i.gT.unsaveContent(c.id),p(!1)):(await i.gT.saveContent(c.id),p(!0))}catch(e){console.error("Error saving/unsaving content:",e),alert("콘텐츠 저장에 실패했습니다.")}finally{j(!1)}}},disabled:v,children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:w?"currentColor":"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5 mr-1",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0111.186 0z"})}),w?"저장됨":"저장하기"]})]})]})]}),(0,s.jsx)("div",{className:"lg:w-1/4",children:a&&(null==c?void 0:c.author)&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(h.Z,{limit:5,title:"팔로우 추천",excludeUserId:c.author.id})})})]})]})})}},6681:function(e,t,a){"use strict";var s=a(7437),r=a(2265),n=a(8223),l=a(3145),o=a(7648),i=a(4362);t.Z=e=>{let{limit:t=3,title:a="팔로우 추천",excludeUserId:c}=e,{isAuthenticated:d,user:u}=(0,i.a)(),[m,h]=(0,r.useState)([]),[x,g]=(0,r.useState)(!0),[f,w]=(0,r.useState)(""),[p,v]=(0,r.useState)({});(0,r.useEffect)(()=>{d&&(async()=>{try{g(!0);let e=(await n.TV.searchUsers("",{limit:t+5})).data||[];(null==u?void 0:u.id)&&(e=e.filter(e=>e.id!==u.id)),c&&(e=e.filter(e=>e.id!==c)),e=e.slice(0,t),h(e),g(!1)}catch(e){console.error("Error fetching recommended users:",e),w("추천 사용자를 불러오는데 실패했습니다."),g(!1)}})()},[d,null==u?void 0:u.id,t,c]);let j=async e=>{if(!p[e]){v(t=>({...t,[e]:!0}));try{let t=m.find(t=>t.id===e);if(!t)return;t.isFollowing?(await n.TV.unfollowUser(e),h(t=>t.map(t=>t.id===e?{...t,isFollowing:!1}:t))):(await n.TV.followUser(e),h(t=>t.map(t=>t.id===e?{...t,isFollowing:!0}:t)))}catch(e){console.error("Error toggling follow status:",e)}finally{v(t=>({...t,[e]:!1}))}}};return d?x?(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[(0,s.jsx)("h2",{className:"text-lg font-medium mb-4",children:a}),(0,s.jsx)("div",{className:"animate-pulse space-y-3",children:[...Array(t)].map((e,t)=>(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)("div",{className:"rounded-full bg-gray-200 h-10 w-10"}),(0,s.jsxs)("div",{className:"flex-1 space-y-2 py-1",children:[(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})]},t))})]}):f?(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[(0,s.jsx)("h2",{className:"text-lg font-medium mb-4",children:a}),(0,s.jsx)("p",{className:"text-red-500 text-sm",children:f})]}):0===m.length?null:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[(0,s.jsx)("h2",{className:"text-lg font-medium mb-4",children:a}),(0,s.jsxs)("div",{className:"space-y-4",children:[m.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)(o.default,{href:"/user/".concat(e.id),className:"flex items-center flex-grow",children:[(0,s.jsx)("div",{className:"relative w-10 h-10 rounded-full overflow-hidden bg-gray-200 mr-3",children:e.avatar?(0,s.jsx)(l.default,{src:e.avatar,alt:e.name||e.email,fill:!0,className:"object-cover"}):(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-500",children:(e.name||e.email).charAt(0).toUpperCase()})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-medium text-sm",children:e.name||e.email}),e.bio?(0,s.jsx)("p",{className:"text-xs text-gray-500 truncate max-w-[150px]",children:e.bio}):(0,s.jsx)("p",{className:"text-xs text-gray-500 truncate max-w-[150px]",children:e.email})]})]}),(0,s.jsx)("button",{onClick:()=>j(e.id),disabled:p[e.id],className:"ml-2 px-3 py-1 text-xs font-medium rounded-full ".concat(e.isFollowing?"text-gray-700 bg-gray-100 hover:bg-gray-200":"text-white bg-blue-whale-600 hover:bg-blue-whale-700"," focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-whale-500"),children:p[e.id]?(0,s.jsx)("span",{className:"inline-block w-4 h-4 border-2 border-t-transparent border-white rounded-full animate-spin"}):e.isFollowing?"팔로잉":"팔로우"})]},e.id)),(0,s.jsx)("div",{className:"pt-2 text-center",children:(0,s.jsx)(o.default,{href:"/search?tab=users",className:"text-sm text-blue-whale-600 hover:text-blue-whale-800",children:"더 많은 사용자 찾기"})})]})]}):null}},4362:function(e,t,a){"use strict";a.d(t,{AuthProvider:function(){return i},a:function(){return o}});var s=a(7437),r=a(2265),n=a(8223);let l=(0,r.createContext)(void 0),o=()=>{let e=(0,r.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},i=e=>{let{children:t}=e,[a,o]=(0,r.useState)(null),[i,c]=(0,r.useState)(!0),[d,u]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{let e=localStorage.getItem("user");if(localStorage.getItem("authToken")&&e)try{{let e=await n.kv.getCurrentUser();o(e),u(!0)}}catch(e){console.error("Error fetching current user:",e),localStorage.removeItem("authToken"),localStorage.removeItem("user")}c(!1)})()},[]);let m=async(e,t)=>{try{let{user:a,token:s}=await n.kv.login(e,t);localStorage.setItem("authToken",s),localStorage.setItem("user",JSON.stringify(a)),o(a),u(!0)}catch(e){throw console.error("Login failed:",e),e}},h=async(e,t)=>{try{let{user:a,token:s}=await n.kv.register(e,t);localStorage.setItem("authToken",s),localStorage.setItem("user",JSON.stringify(a)),o(a),u(!0)}catch(e){throw console.error("Registration failed:",e),e}},x=async()=>{try{await n.kv.logout()}catch(e){console.error("Logout API call failed:",e)}finally{localStorage.removeItem("authToken"),localStorage.removeItem("user"),o(null),u(!1)}};return(0,s.jsx)(l.Provider,{value:{user:a,isAuthenticated:d,loading:i,login:m,register:h,logout:x},children:t})}},8223:function(e,t,a){"use strict";a.d(t,{Lz:function(){return l},TV:function(){return o},gT:function(){return n},kv:function(){return r}});let s=a(3464).Z.create({baseURL:"http://bluewhale-backend-env.eba-wehmnn34.ap-northeast-2.elasticbeanstalk.com",headers:{"Content-Type":"application/json"}});s.interceptors.request.use(e=>{let t=localStorage.getItem("authToken");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),s.interceptors.response.use(e=>e,e=>(e.response&&401===e.response.status&&(localStorage.removeItem("authToken"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)));let r={login:async(e,t)=>(await s.post("/auth/login",{email:e,password:t})).data,register:async(e,t)=>(await s.post("/auth/register",{email:e,password:t})).data,getCurrentUser:async()=>(await s.get("/auth/me")).data,logout:async()=>(await s.post("/auth/logout")).data},n={getContent:async e=>(await s.get("/content",{params:e})).data,getGlobalTopContent:async e=>(await s.get("/content/global-top",{params:e})).data,getPersonalizedContent:async e=>(await s.get("/content/personalized",{params:e})).data,getLocalContent:async e=>(await s.get("/content/local",{params:e})).data,getContentById:async e=>(await s.get("/content/".concat(e))).data,createContent:async e=>(await s.post("/content",e,{headers:{"Content-Type":"multipart/form-data"}})).data,updateContent:async(e,t)=>(await s.put("/content/".concat(e),t,{headers:{"Content-Type":"multipart/form-data"}})).data,deleteContent:async e=>(await s.delete("/content/".concat(e))).data,searchContent:async(e,t)=>(await s.get("/content/search",{params:{query:e,...t}})).data,getUserContent:async(e,t)=>(await s.get(e?"/content/user/".concat(e):"/content/my-content",{params:t})).data,saveContent:async e=>(await s.post("/content/".concat(e,"/save"))).data,unsaveContent:async e=>(await s.delete("/content/".concat(e,"/save"))).data,getSavedContent:async e=>(await s.get("/content/saved",{params:e})).data},l={getNotifications:async e=>(await s.get("/notifications",{params:e})).data,markAsRead:async e=>(await s.put("/notifications/".concat(e,"/read"))).data,markAllAsRead:async()=>(await s.put("/notifications/read-all")).data,getUnreadCount:async()=>(await s.get("/notifications/unread-count")).data},o={getUserProfile:async e=>(await s.get("/users/".concat(e))).data,updateUserProfile:async e=>{let t=new FormData;return e.name&&t.append("name",e.name),e.bio&&t.append("bio",e.bio),e.avatar&&t.append("avatar",e.avatar),(await s.put("/users/profile",t,{headers:{"Content-Type":"multipart/form-data"}})).data},followUser:async e=>(await s.post("/users/".concat(e,"/follow"))).data,unfollowUser:async e=>(await s.delete("/users/".concat(e,"/follow"))).data,getUserFollowers:async(e,t)=>(await s.get("/users/".concat(e,"/followers"),{params:t})).data,getUserFollowing:async(e,t)=>(await s.get("/users/".concat(e,"/following"),{params:t})).data,searchUsers:async(e,t)=>(await s.get("/users/search",{params:{query:e,...t}})).data}},4982:function(){}},function(e){e.O(0,[508,415,301,648,145,971,117,744],function(){return e(e.s=5015)}),_N_E=e.O()}]);