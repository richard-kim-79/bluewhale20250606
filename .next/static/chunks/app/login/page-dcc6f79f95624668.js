(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{7692:function(t,e,a){Promise.resolve().then(a.bind(a,8991))},8991:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return m}});var s=a(7437),n=a(2265),r=a(9501),o=a(3590),l=a(1115),c=a(7648),i=a(9376),d=a(4362);let u=l.z.object({email:l.z.string().email("유효한 이메일을 입력해주세요"),password:l.z.string().min(6,"비밀번호는 최소 6자 이상이어야 합니다")});function m(){let t=(0,i.useRouter)(),{login:e}=(0,d.a)(),[a,l]=(0,n.useState)(!1),[m,g]=(0,n.useState)(""),{register:p,handleSubmit:h,formState:{errors:w}}=(0,r.cI)({resolver:(0,o.F)(u)}),f=async a=>{l(!0),g("");try{await e(a.email,a.password),t.push("/")}catch(t){var s,n;g((null===(n=t.response)||void 0===n?void 0:null===(s=n.data)||void 0===s?void 0:s.message)||"로그인에 실패했습니다")}finally{l(!1)}};return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[(0,s.jsxs)("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[(0,s.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"로그인"}),(0,s.jsxs)("p",{className:"mt-2 text-center text-sm text-gray-600",children:["계정이 없으신가요?"," ",(0,s.jsx)(c.default,{href:"/register",className:"font-medium text-blue-whale-600 hover:text-blue-whale-500",children:"회원가입"})]})]}),(0,s.jsx)("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:(0,s.jsxs)("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[m&&(0,s.jsx)("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:m}),(0,s.jsxs)("form",{className:"space-y-6",onSubmit:h(f),children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"이메일"}),(0,s.jsxs)("div",{className:"mt-1",children:[(0,s.jsx)("input",{id:"email",type:"email",autoComplete:"email",className:"input-field",...p("email")}),w.email&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:w.email.message})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"비밀번호"}),(0,s.jsxs)("div",{className:"mt-1",children:[(0,s.jsx)("input",{id:"password",type:"password",autoComplete:"current-password",className:"input-field",...p("password")}),w.password&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:w.password.message})]})]}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{type:"submit",disabled:a,className:"w-full btn-primary flex justify-center py-2 px-4",children:a?(0,s.jsxs)("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"로그인"})})]})]})})]})}},4362:function(t,e,a){"use strict";a.d(e,{AuthProvider:function(){return c},a:function(){return l}});var s=a(7437),n=a(2265),r=a(8223);let o=(0,n.createContext)(void 0),l=()=>{let t=(0,n.useContext)(o);if(void 0===t)throw Error("useAuth must be used within an AuthProvider");return t},c=t=>{let{children:e}=t,[a,l]=(0,n.useState)(null),[c,i]=(0,n.useState)(!0),[d,u]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{let t=localStorage.getItem("user");if(localStorage.getItem("authToken")&&t)try{{let t=await r.kv.getCurrentUser();l(t),u(!0)}}catch(t){console.error("Error fetching current user:",t),localStorage.removeItem("authToken"),localStorage.removeItem("user")}i(!1)})()},[]);let m=async(t,e)=>{try{let{user:a,token:s}=await r.kv.login(t,e);localStorage.setItem("authToken",s),localStorage.setItem("user",JSON.stringify(a)),l(a),u(!0)}catch(t){throw console.error("Login failed:",t),t}},g=async(t,e)=>{try{let{user:a,token:s}=await r.kv.register(t,e);localStorage.setItem("authToken",s),localStorage.setItem("user",JSON.stringify(a)),l(a),u(!0)}catch(t){throw console.error("Registration failed:",t),t}},p=async()=>{try{await r.kv.logout()}catch(t){console.error("Logout API call failed:",t)}finally{localStorage.removeItem("authToken"),localStorage.removeItem("user"),l(null),u(!1)}};return(0,s.jsx)(o.Provider,{value:{user:a,isAuthenticated:d,loading:c,login:m,register:g,logout:p},children:e})}},8223:function(t,e,a){"use strict";a.d(e,{Lz:function(){return o},TV:function(){return l},gT:function(){return r},kv:function(){return n}});let s=a(3464).Z.create({baseURL:"http://bluewhale-backend-env.eba-wehmnn34.ap-northeast-2.elasticbeanstalk.com",headers:{"Content-Type":"application/json"}});s.interceptors.request.use(t=>{let e=localStorage.getItem("authToken");return e&&(t.headers.Authorization="Bearer ".concat(e)),t},t=>Promise.reject(t)),s.interceptors.response.use(t=>t,t=>(t.response&&401===t.response.status&&(localStorage.removeItem("authToken"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(t)));let n={login:async(t,e)=>(await s.post("/auth/login",{email:t,password:e})).data,register:async(t,e)=>(await s.post("/auth/register",{email:t,password:e})).data,getCurrentUser:async()=>(await s.get("/auth/me")).data,logout:async()=>(await s.post("/auth/logout")).data},r={getContent:async t=>(await s.get("/content",{params:t})).data,getGlobalTopContent:async t=>(await s.get("/content/global-top",{params:t})).data,getPersonalizedContent:async t=>(await s.get("/content/personalized",{params:t})).data,getLocalContent:async t=>(await s.get("/content/local",{params:t})).data,getContentById:async t=>(await s.get("/content/".concat(t))).data,createContent:async t=>(await s.post("/content",t,{headers:{"Content-Type":"multipart/form-data"}})).data,updateContent:async(t,e)=>(await s.put("/content/".concat(t),e,{headers:{"Content-Type":"multipart/form-data"}})).data,deleteContent:async t=>(await s.delete("/content/".concat(t))).data,searchContent:async(t,e)=>(await s.get("/content/search",{params:{query:t,...e}})).data,getUserContent:async(t,e)=>(await s.get(t?"/content/user/".concat(t):"/content/my-content",{params:e})).data,saveContent:async t=>(await s.post("/content/".concat(t,"/save"))).data,unsaveContent:async t=>(await s.delete("/content/".concat(t,"/save"))).data,getSavedContent:async t=>(await s.get("/content/saved",{params:t})).data},o={getNotifications:async t=>(await s.get("/notifications",{params:t})).data,markAsRead:async t=>(await s.put("/notifications/".concat(t,"/read"))).data,markAllAsRead:async()=>(await s.put("/notifications/read-all")).data,getUnreadCount:async()=>(await s.get("/notifications/unread-count")).data},l={getUserProfile:async t=>(await s.get("/users/".concat(t))).data,updateUserProfile:async t=>{let e=new FormData;return t.name&&e.append("name",t.name),t.bio&&e.append("bio",t.bio),t.avatar&&e.append("avatar",t.avatar),(await s.put("/users/profile",e,{headers:{"Content-Type":"multipart/form-data"}})).data},followUser:async t=>(await s.post("/users/".concat(t,"/follow"))).data,unfollowUser:async t=>(await s.delete("/users/".concat(t,"/follow"))).data,getUserFollowers:async(t,e)=>(await s.get("/users/".concat(t,"/followers"),{params:e})).data,getUserFollowing:async(t,e)=>(await s.get("/users/".concat(t,"/following"),{params:e})).data,searchUsers:async(t,e)=>(await s.get("/users/search",{params:{query:t,...e}})).data}}},function(t){t.O(0,[301,648,558,971,117,744],function(){return t(t.s=7692)}),_N_E=t.O()}]);