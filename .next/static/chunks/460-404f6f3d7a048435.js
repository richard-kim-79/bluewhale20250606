"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[460],{460:function(e,t,a){var n=a(7437),r=a(2265),o=a(8223),s=a(3145),c=a(7648),l=a(4362);t.Z=e=>{let{userId:t}=e,{user:a}=(0,l.a)(),[i,d]=(0,r.useState)([]),[u,g]=(0,r.useState)(!0),[m,f]=(0,r.useState)(""),[h,w]=(0,r.useState)({});(0,r.useEffect)(()=>{t&&(async()=>{try{g(!0);let e=((await o.TV.getUserFollowing(t)).data||[]).map(e=>({...e,isFollowing:!0}));d(e),g(!1)}catch(e){console.error("Error fetching following:",e),f("팔로잉 목록을 불러오는데 실패했습니다."),g(!1)}})()},[t]);let y=async e=>{if(!h[e]&&a){w(t=>({...t,[e]:!0}));try{await o.TV.unfollowUser(e),d(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Error unfollowing user:",e)}finally{w(t=>({...t,[e]:!1}))}}};return u?(0,n.jsx)("div",{className:"flex justify-center py-12",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-whale-600"})}):m?(0,n.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mt-4",children:(0,n.jsx)("p",{children:m})}):0===i.length?(0,n.jsx)("div",{className:"text-center py-10 text-gray-500",children:"팔로잉하는 사용자가 없습니다."}):(0,n.jsx)("div",{className:"space-y-4",children:i.map(e=>(0,n.jsxs)("div",{className:"flex items-center justify-between p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition",children:[(0,n.jsxs)(c.default,{href:"/user/".concat(e.id),className:"flex items-center flex-grow",children:[(0,n.jsx)("div",{className:"relative w-12 h-12 rounded-full overflow-hidden bg-gray-200 mr-4",children:e.avatar?(0,n.jsx)(s.default,{src:e.avatar,alt:e.name||e.email,fill:!0,className:"object-cover"}):(0,n.jsx)("div",{className:"w-full h-full flex items-center justify-center text-gray-500",children:(e.name||e.email).charAt(0).toUpperCase()})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"font-medium",children:e.name||e.email}),e.bio&&(0,n.jsx)("p",{className:"text-sm text-gray-500 line-clamp-1",children:e.bio}),!e.bio&&(0,n.jsx)("p",{className:"text-sm text-gray-500",children:e.email})]})]}),a&&a.id===t&&(0,n.jsx)("button",{onClick:()=>y(e.id),disabled:h[e.id],className:"ml-2 px-3 py-1 text-sm font-medium rounded-full text-gray-700 bg-gray-100 hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-whale-500",children:h[e.id]?(0,n.jsx)("span",{className:"inline-block w-4 h-4 border-2 border-t-transparent border-gray-700 rounded-full animate-spin"}):"언팔로우"})]},e.id))})}},4362:function(e,t,a){a.d(t,{AuthProvider:function(){return l},a:function(){return c}});var n=a(7437),r=a(2265),o=a(8223);let s=(0,r.createContext)(void 0),c=()=>{let e=(0,r.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},l=e=>{let{children:t}=e,[a,c]=(0,r.useState)(null),[l,i]=(0,r.useState)(!0),[d,u]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{let e=localStorage.getItem("user");if(localStorage.getItem("authToken")&&e)try{{let e=await o.kv.getCurrentUser();c(e),u(!0)}}catch(e){console.error("Error fetching current user:",e),localStorage.removeItem("authToken"),localStorage.removeItem("user")}i(!1)})()},[]);let g=async(e,t)=>{try{let{user:a,token:n}=await o.kv.login(e,t);localStorage.setItem("authToken",n),localStorage.setItem("user",JSON.stringify(a)),c(a),u(!0)}catch(e){throw console.error("Login failed:",e),e}},m=async(e,t)=>{try{let{user:a,token:n}=await o.kv.register(e,t);localStorage.setItem("authToken",n),localStorage.setItem("user",JSON.stringify(a)),c(a),u(!0)}catch(e){throw console.error("Registration failed:",e),e}},f=async()=>{try{await o.kv.logout()}catch(e){console.error("Logout API call failed:",e)}finally{localStorage.removeItem("authToken"),localStorage.removeItem("user"),c(null),u(!1)}};return(0,n.jsx)(s.Provider,{value:{user:a,isAuthenticated:d,loading:l,login:g,register:m,logout:f},children:t})}},8223:function(e,t,a){a.d(t,{Lz:function(){return s},TV:function(){return c},gT:function(){return o},kv:function(){return r}});let n=a(3464).Z.create({baseURL:"http://bluewhale-backend-env.eba-wehmnn34.ap-northeast-2.elasticbeanstalk.com",headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{let t=localStorage.getItem("authToken");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),n.interceptors.response.use(e=>e,e=>(e.response&&401===e.response.status&&(localStorage.removeItem("authToken"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)));let r={login:async(e,t)=>(await n.post("/auth/login",{email:e,password:t})).data,register:async(e,t)=>(await n.post("/auth/register",{email:e,password:t})).data,getCurrentUser:async()=>(await n.get("/auth/me")).data,logout:async()=>(await n.post("/auth/logout")).data},o={getContent:async e=>(await n.get("/content",{params:e})).data,getGlobalTopContent:async e=>(await n.get("/content/global-top",{params:e})).data,getPersonalizedContent:async e=>(await n.get("/content/personalized",{params:e})).data,getLocalContent:async e=>(await n.get("/content/local",{params:e})).data,getContentById:async e=>(await n.get("/content/".concat(e))).data,createContent:async e=>(await n.post("/content",e,{headers:{"Content-Type":"multipart/form-data"}})).data,updateContent:async(e,t)=>(await n.put("/content/".concat(e),t,{headers:{"Content-Type":"multipart/form-data"}})).data,deleteContent:async e=>(await n.delete("/content/".concat(e))).data,searchContent:async(e,t)=>(await n.get("/content/search",{params:{query:e,...t}})).data,getUserContent:async(e,t)=>(await n.get(e?"/content/user/".concat(e):"/content/my-content",{params:t})).data,saveContent:async e=>(await n.post("/content/".concat(e,"/save"))).data,unsaveContent:async e=>(await n.delete("/content/".concat(e,"/save"))).data,getSavedContent:async e=>(await n.get("/content/saved",{params:e})).data},s={getNotifications:async e=>(await n.get("/notifications",{params:e})).data,markAsRead:async e=>(await n.put("/notifications/".concat(e,"/read"))).data,markAllAsRead:async()=>(await n.put("/notifications/read-all")).data,getUnreadCount:async()=>(await n.get("/notifications/unread-count")).data},c={getUserProfile:async e=>(await n.get("/users/".concat(e))).data,updateUserProfile:async e=>{let t=new FormData;return e.name&&t.append("name",e.name),e.bio&&t.append("bio",e.bio),e.avatar&&t.append("avatar",e.avatar),(await n.put("/users/profile",t,{headers:{"Content-Type":"multipart/form-data"}})).data},followUser:async e=>(await n.post("/users/".concat(e,"/follow"))).data,unfollowUser:async e=>(await n.delete("/users/".concat(e,"/follow"))).data,getUserFollowers:async(e,t)=>(await n.get("/users/".concat(e,"/followers"),{params:t})).data,getUserFollowing:async(e,t)=>(await n.get("/users/".concat(e,"/following"),{params:t})).data,searchUsers:async(e,t)=>(await n.get("/users/search",{params:{query:e,...t}})).data}}}]);